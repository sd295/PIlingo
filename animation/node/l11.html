<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A German Fairy Tale - An Animation</title>
<meta http-equiv="refresh" content="26; url=../../node.html" />
<style>
    /* --- SETUP & MASTER TIMER --- */
    :root {
        --sky-day: #bde0fe;
        --sky-dusk: #ffafcc;
        --sky-night: #03045e;
        --sun-color: #ffc857;
        --hill-green: #588157;
        --forest-green: #3a5a40;
        --castle-grey: #6c757d;
        --animation-duration: 45s; /* An epic, long duration */
    }

    body {
        margin: 0;
        height: 100vh;
        overflow: hidden;
        background-color: var(--sky-night);
        animation: skyCycle var(--animation-duration) linear infinite;
        font-family: 'Garamond', 'Times New Roman', serif;
    }

    .scene-container {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    /* --- CELESTIAL & ATMOSPHERIC ELEMENTS --- */
    .sun-path {
        position: absolute;
        width: 180vh; height: 180vh;
        top: 50%; left: 50%;
        animation: sunRotation var(--animation-duration) linear infinite;
    }
    .sun {
        position: absolute;
        top: -50px; left: calc(50% - 50px);
        width: 100px; height: 100px;
        background: radial-gradient(circle, white, var(--sun-color));
        border-radius: 50%;
        box-shadow: 0 0 60px var(--sun-color);
    }
    .stars {
        position: absolute;
        width: 1px; height: 1px; background: transparent;
        box-shadow: -15vw 25vh 1px white, 85vw 35vh 2px white, 55vw 15vh 1px white, 20vw 85vh 1px white;
        animation: starFade var(--animation-duration) linear infinite;
    }
    .mist {
        position: absolute;
        bottom: 0;
        width: 100%; height: 50vh;
        background: linear-gradient(to top, rgba(255,255,255,0.6), transparent);
        z-index: 10;
        animation: mistFade var(--animation-duration) linear infinite;
    }
    .snow-container {
        position: absolute;
        width: 100%; height: 100%;
        z-index: 15;
        pointer-events: none;
    }
    .snowflake {
        position: absolute;
        top: -20px;
        width: 8px; height: 8px;
        background: white;
        border-radius: 50%;
        opacity: 0;
        animation-name: fall;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
    }

    /* --- LANDSCAPE & SCENERY (WITH PARALLAX) --- */
    .hill {
        position: absolute;
        bottom: 0;
        width: 120%; height: 60vh;
        background-color: var(--hill-green);
        border-radius: 50% / 100% 100% 0 0;
        animation: parallax var(--animation-duration) linear infinite;
    }
    .hill.far { z-index: 1; left: -20%; background-color: #344e41; animation-duration: calc(var(--animation-duration) * 2); }
    .hill.mid { z-index: 3; right: -20%; height: 50vh; animation-duration: calc(var(--animation-duration) * 1.5); }
    .hill.near { z-index: 5; left: -10%; height: 40vh; background-color: #6a994e; }

    .forest {
        position: absolute;
        bottom: 38vh; width: 100%;
        display: flex; justify-content: space-around;
        z-index: 4;
    }
    .fir-tree {
        width: 0; height: 0;
        border-left: 30px solid transparent; border-right: 30px solid transparent;
        border-bottom: 90px solid var(--forest-green);
    }

    /* --- ARCHITECTURE --- */
    .castle {
        position: absolute;
        bottom: 58vh; left: 15%;
        z-index: 2;
    }
    .castle .tower { position: absolute; width: 40px; height: 100px; background-color: var(--castle-grey); }
    .castle .tower.main { left: 40px; height: 120px; }
    .castle .tower::before { content: ''; position: absolute; top: -40px; left: -10px; width: 0; height: 0; border-left: 30px solid transparent; border-right: 30px solid transparent; border-bottom: 40px solid #495057; }
    .castle .wall { position: absolute; top: 60px; left: 0; width: 120px; height: 60px; background-color: #adb5bd; }

    .village {
        position: absolute;
        bottom: 10vh; right: 10%;
        display: flex; gap: 10px;
        z-index: 6;
    }
    .house {
        width: 80px; height: 100px;
        background-color: #f8f9fa;
        position: relative;
    }
    .house::before { content: ''; position: absolute; top: -40px; left: -10px; width: 100px; height: 40px; background-color: #8B4513; clip-path: polygon(0 100%, 50% 0, 100% 100%); }
    .house::after { content: 'X'; font-size: 100px; color: rgba(0,0,0,0.7); position: absolute; top: 10px; left: 0; width: 100%; height: 100%; line-height: 0.8; }
    .house .window {
        position: absolute;
        top: 50px; left: 30px;
        width: 20px; height: 20px;
        background-color: #03045e;
        animation: villageLights var(--animation-duration) linear infinite;
    }
    .christmas-lights {
        position: absolute;
        top: -10px; left: 0;
        width: 100%;
    }

    /* --- MODERNITY (THE TRAIN) --- */
    .autobahn {
        position: absolute;
        bottom: 35vh;
        width: 100%; height: 20px;
        background: #495057;
        z-index: 4;
    }
    .car {
        position: absolute;
        bottom: 36vh;
        width: 60px; height: 25px;
        background-color: #dc2f02;
        border-radius: 10px 10px 0 0;
        z-index: 4;
        animation: driveAcross var(--animation-duration) linear infinite;
    }
    .car::before { content: ''; position: absolute; top: 5px; left: 10px; width: 15px; height: 10px; background: #87CEEB; }
    .car::after { content: ''; position: absolute; top: 5px; right: 10px; width: 20px; height: 10px; background: #87CEEB; }

    /* --- KEYFRAME DEFINITIONS --- */

    @keyframes skyCycle {
        0%   { background-color: #020122; } /* Pre-Dawn */
        25%  { background-color: var(--sky-day); } /* Day */
        70%  { background-color: var(--sky-dusk); } /* Dusk */
        90%  { background-color: var(--sky-night); } /* Night */
        100% { background-color: #020122; }
    }
    @keyframes sunRotation {
        from { transform: rotate(-90deg); }
        to { transform: rotate(90deg); }
    }
    @keyframes starFade {
        0%, 20% { opacity: 0; }
        80%, 100% { opacity: 1; }
    }
    @keyframes mistFade {
        0% { opacity: 0.6; }
        25% { opacity: 0; }
        100% { opacity: 0; }
    }
    @keyframes parallax {
        from { background-position-x: 0; }
        to { background-position-x: -200px; }
    }
    @keyframes driveAcross {
        0%, 20% { left: -100px; } /* Waits for morning */
        60% { left: 110%; } /* Crosses during day */
        61%, 100% { left: -100px; }
    }
    @keyframes villageLights {
        0%, 15% { background-color: #03045e; box-shadow: none; } /* Off pre-dawn */
        65%, 100% { background-color: #fbc22d; box-shadow: 0 0 8px #fbc22d; } /* On at dusk/night */
    }
    @keyframes fall {
        0% { transform: translateY(0) rotate(0); opacity: 0; }
        80% { opacity: 1; }
        100% { transform: translateY(100vh) rotate(360deg); opacity: 1; }
    }

</style>
</head>
<body>

<div class="scene-container">
    <div class="stars"></div>
    <div class="sun-path">
        <div class="sun"></div>
    </div>
    
    <div class="hill far"></div>
    <div class="castle">
        <div class="wall"></div><div class="tower"></div><div class="tower main"></div>
    </div>
    <div class="hill mid"></div>
    <div class="forest">
        <div class="fir-tree t1"></div><div class="fir-tree t2"></div>
        <div class="fir-tree t3"></div><div class="fir-tree t2"></div>
        <div class="fir-tree t1"></div><div class="fir-tree t3"></div>
    </div>
    <div class="hill near"></div>
    
    <div class="autobahn"></div>
    <div class="car"></div>

    <div class="village">
        <div class="house"><div class="window"></div><div class="christmas-lights"></div></div>
        <div class="house" style="transform: scale(0.9);"><div class="window"></div><div class="christmas-lights"></div></div>
    </div>

    <div class="mist"></div>
    <div class="snow-container"></div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const snowContainer = document.querySelector('.snow-container');
        const villageHouses = document.querySelectorAll('.house');
        const animationDuration = 45; // Must match --animation-duration

        // Generate Snow for the winter/night phase
        for (let i = 0; i < 150; i++) {
            const flake = document.createElement('div');
            flake.className = 'snowflake';
            flake.style.left = `${Math.random() * 100}vw`;
            flake.style.animationDuration = `${5 + Math.random() * 10}s`;
            // Snow starts falling only in the last 25% of the animation cycle
            flake.style.animationDelay = `${(0.75 * animationDuration) + Math.random() * (0.25 * animationDuration)}s`;
            snowContainer.appendChild(flake);
        }

        // Generate Christmas Lights for the village houses
        const lightColors = ['#dc2f02', '#f4a261', '#588157', '#0077b6'];
        villageHouses.forEach(house => {
            const lightContainer = house.querySelector('.christmas-lights');
            for (let i = 0; i < 10; i++) {
                const light = document.createElement('div');
                light.style.position = 'absolute';
                light.style.width = '6px';
                light.style.height = '6px';
                light.style.borderRadius = '50%';
                light.style.backgroundColor = lightColors[Math.floor(Math.random() * lightColors.length)];
                light.style.left = `${10 + i * 8}%`;
                // Lights twinkle only in the last 35% of the cycle
                light.style.animation = `twinkle 1.5s infinite alternate`;
                light.style.animationDelay = `${(0.65 * animationDuration) + Math.random()}s`;
                lightContainer.appendChild(light);
            }
        });

        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            @keyframes fall { to { transform: translateY(100vh) rotate(360deg); } }
            @keyframes twinkle { 
                0%, 100% { opacity: 0; box-shadow: none; }
                50% { opacity: 1; box-shadow: 0 0 5px currentColor; }
            }
        `;
        document.head.appendChild(styleSheet);
    });
</script>

</body>
</html>